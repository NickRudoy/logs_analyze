# Log Analyzer Pro

Профессиональный инструмент для анализа логов веб-сервера (access logs), выявления ботов, накруток и подозрительной активности.

## Функциональность

*   **Парсинг логов**: Поддержка форматов Apache и Nginx (обычные и .gz архивы).
*   **Анализ трафика**: Выявление прямых заходов, отказов (Bounce Rate) и ботов.
*   **Геолокация**: Определение страны и провайдера по IP (поддержка локальной БД и API).
*   **Детекция угроз**:
    *   Поиск подозрительных IP (частые запросы, сканирование уязвимостей).
    *   Анализ User-Agent на подмену.
    *   Выявление аномалий нагрузки (DDoS атаки).
*   **Отчеты**:
    *   **Excel (.xlsx)**: Подробные таблицы с данными.
    *   **HTML**: Красивые интерактивные дашборды для браузера.
*   **AI Аналитика**: Интеграция с GigaChat для автоматического анализа угроз и генерации рекомендаций.

## Установка

Проект требует Python 3. Простейший способ начать работу — запустить скрипт установки:

```bash
./setup.sh
```

Скрипт автоматически:
1.  Создаст виртуальное окружение (поддерживает `venv` и `ai_env`).
2.  Установит необходимые библиотеки.
3.  Покажет инструкцию по запуску.

## Использование

Логи для анализа следует поместить в папку, или указать путь к ним. Программа автоматически создаст папку `results/<domain_name>/`, куда сохранит все отчеты.

### 1. Базовый анализ
Анализ всех логов в папке `logs/`:
```bash
./venv/bin/python3 main.py logs/
```
*(Если вы используете `ai_env`, замените `venv` на `ai_env`)*

### 2. Форматы отчетов
Генерация HTML отчета (по умолчанию Excel):
```bash
./venv/bin/python3 main.py logs/ --format html
```
Генерация всех форматов сразу:
```bash
./venv/bin/python3 main.py logs/ --format all
```

### 3. AI Анализ
Для использования AI анализатора укажите ключ авторизации (GigaChat):
```bash
./venv/bin/python3 main.py logs/ --ai --auth-key <ВАШ_КЛЮЧ>
```

### 4. Быстрая геолокация (GeoIP2/GeoLite2)
При запуске `./setup.sh` автоматически загружается GeoLite2-City в папку `geoip/`. Конфиг по умолчанию указывает на `geoip/GeoLite2-City.mmdb` — геолокация работает сразу без API.

- Пропустить загрузку при setup: `./setup.sh --no-geoip-db`
- Указать свой путь: `./venv/bin/python3 main.py logs/ --mmdb /путь/к/GeoLite2-City.mmdb`

## Структура проекта

*   `main.py`: Точка входа в программу.
*   `core/`: Основная логика (парсинг, анализ, geoip).
*   `report/`: Генераторы отчетов (Excel, HTML).
*   `ai/`: Модули интеграции с нейросетями.
*   `config.py`: Настройки.
*   `results/`: Папка с результатами анализа.

## Результаты

После завершения работы скрипта, ищите отчеты в папке `results/`:
*   `results/site_com/site_com_report_DATE.xlsx`
*   `results/site_com/site_com_report_DATE.html`
